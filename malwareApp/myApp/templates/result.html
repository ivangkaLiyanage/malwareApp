{% extends 'resultdata.html' %}
{% load static %}

{% block data %}

<div>
    <div class="result-container">
      <div class="result-desktop-navigation">
        <div class="result-left">
            <img
            alt="pastedImage"
            src="{% static 'public/groupLogo.png' %}" 
            class="result-logo"
            />
        </div>
      </div>

        <div class="result-container1">
          <div class="result-container2">
            <h1 class="result-text">Result</h1>
            {% for file in data %}
              {% if file.malware_status %}
                <span class="result-text01" style="background-color: red;">Malware Found</span>
              {% else %}
                  <span class="result-text01" style="background-color: green;">Malware Not Found</span>
              {% endif %}     
            {% empty %}
              No files uploaded yet.
            {% endfor %}
            </span>
          </div>
        </div>

        <div class="result-quick">
          <div class="result-container3">
            <div class="result-file">
              <div class="result-container4">
                <h3 class="result-text03">Name</h2>
                <span class="result-text04">
                  {% for file in data %}
                    {{ file.file_name }}
                  {% empty %}
                    No files uploaded yet.
                  {% endfor %}
                </span>
              </div>
            </div>
            
            <div class="result-file1">
              <div class="result-container5">
                <h3 class="result-text05">Size</h2>
                <span class="result-text06">
                {% for file in data %}
                  {{ file.file_size }} bytes
                {% empty %}
                  No files uploaded yet.
                {% endfor %}
                </span>
              </div>
            </div>

            <div class="result-file2">
              <div class="result-container6">
                <h3 class="result-text07">Status</h3>
                <span class="result-text08">
                  <span></span>
                  <span class="result-text10" style="color: 
                    {% for file in data %}
                      {% if file.malware_score >= 0 and file.malware_score < 10 %}
                          green;
                      {% elif file.malware_score >= 20 and file.malware_score < 40 %}
                          blue;
                      {% elif file.malware_score >= 40 and file.malware_score < 60 %}
                          orange;
                      {% else %}
                          red;
                      {% endif %}
                    {% empty %}
                        black; 
                    {% endfor %}
                    ">
                    {% for file in data %}
                      {% if file.malware_score >= 0 and file.malware_score < 5 %}
                        Clean
                      {% elif file.malware_score >= 5 and file.malware_score < 20 %}
                        No Need Action
                      {% elif file.malware_score >= 20 and file.malware_score < 40 %}
                        Controllable
                      {% elif file.malware_score >= 40 and file.malware_score < 60 %}
                        Critical
                      {% else %}
                        Highly Critical
                      {% endif %}
                    {% empty %}
                      No files uploaded yet.
                    {% endfor %} 
                  </span>
                </span>
              </div>
            </div>
            <div class="result-file3">
              <div class="result-container7">
                <h3 class="result-text11">Malicious Score</h2>
                  {% for file in data %}
                    <span class="result-text12" style="color: 
                      {% if file.malware_score >= 0 and file.malware_score < 20 %}
                        green;
                      {% elif file.malware_score >= 20 and file.malware_score < 50 %}
                        orange;
                      {% else %}
                        red;
                      {% endif %}">
                      {{ file.malware_score }}%
                      {% if file.malware_score >= 0 and file.malware_score < 20 %}
                          (Low)
                      {% elif file.malware_score >= 20 and file.malware_score < 50 %}
                          (Medium)
                      {% else %}
                          (High)
                      {% endif %}
                    </span>
                  {% empty %}
                      <span class="result-text12">No files uploaded yet.</span>
                  {% endfor %}
                </span>
              </div>
            </div>
          </div>
        </div>

        <div class="result-reportdetails">
          <div class="result-information">
            <h2 class="result-heading">Information</h2>
            <div class="result-fileid">
              <span class="result-text13">File ID&nbsp;</span>
              <span class="result-text14">
                {% for file in data %}
                  {{ file.id }} 
                  {% empty %}
                  No files uploaded yet.
                {% endfor %}   
              </span>
            </div>

            <div class="result-timestamp">
              <span class="result-text15">Timestamp</span>
              <span class="result-text16">
                {% for file in data %}
                  {{ file.submission_date }} 
                  {% empty %}
                  No files uploaded yet.
                {% endfor %}   
              </span>
            </div>

            <div class="result-fileextension">
              <span class="result-text17">File Extension</span>
              <span class="result-text18">
                {% for file in data %}
                  {{ file.file_extension }} 
                  {% empty %}
                  No files uploaded yet.
                {% endfor %}  
              </span>
            </div>

            <div class="result-md5checksum">
              <span class="result-text19">
                <span class="result-text20">MD5 Checksum</span>
                <br />
              </span>
              <span class="result-text22">
                {% for file in data %}
                  {{ file.md5_checksum }} 
                  {% empty %}
                  No files uploaded yet.
                {% endfor %}  
              </span>
            </div>

            <div class="result-sha256checksum">
              <span class="result-text23">
                <span class="result-text24">SHA256 Checksum</span>
                <br />
              </span>
              <span class="result-text26">
                {% for file in data %}
                  {{ file.sha256_checksum }} 
                  {% empty %}
                  No files uploaded yet.
                {% endfor %}  
              </span>
            </div>
          </div>

          <div class="result-network">
            <h2 class="result-text27">Network</h2>
            <div class="result-outboundip">
              <span class="result-text28">Outbound IP</span>
              <span class="result-text29">
                {% for file in data %}
                  {{ file.user_ip }} 
                  {% empty %}
                  No files uploaded yet.
                {% endfor %}  
              </span>
            </div>

            <div class="result-httprefere">
              <span class="result-text30">
                <span class="result-text31">HTTP &nbsp;Refere</span>
                <br />
              </span>
              <span class="result-text33">
                <span>
                  {% for file in data %}
                    {{ file.http_referer }} 
                    {% empty %}
                    No files uploaded yet.
                  {% endfor %}    
                </span>
                <br />
              </span>
            </div>

            <div class="result-httphost">
              <span class="result-text36">HTTP Host</span>
              <span class="result-text37">
                <span>
                  {% for file in data %}
                    {{ file.http_host }} 
                    {% empty %}
                    No files uploaded yet.
                  {% endfor %}                            
                </span>
                <br />
              </span>
            </div>

            <div class="result-servername">
              <span class="result-text40">Server Name</span>
              <span class="result-text41">
                <span>
                  {% for file in data %}
                    {{ file.server_name }} 
                    {% empty %}
                    No files uploaded yet.
                  {% endfor %}                               
                </span>
                <br />
              </span>
            </div>

            <div class="result-port">
              <span class="result-text44">Port</span>
              <span class="result-text45">
                {% for file in data %}
                  {{ file.server_port }} 
                  {% empty %}
                  No files uploaded yet.
                {% endfor %}    
              </span>
            </div>

            <div class="result-requestmethod">
              <span class="result-text50">Request Method</span>
              <span class="result-text51">
                {% for file in data %}
                  {{ file.request_method }} 
                  {% empty %}
                  No files uploaded yet.
                {% endfor %}                          
              </span>
            </div>

            <div class="result-device">
              <span class="result-text56">
                <span class="result-text57">Device</span>
                <br />
              </span>
              <span class="result-text59">
                {% for file in data %}
                    {{ file.user_agent }} 
                    {% empty %}
                    No files uploaded yet.
                {% endfor %}         
              </span>
            </div>
          </div>
        </div>

        <div class="result-button">
          <div class="result-container16">
            <a href="{% url 'home' %}">
              <button type="button" class="result-button1  btn btn-outline-secondary">
                  Start Again
              </button>
            </a>       
            {% for file in data %}
              <a href="{% url 'generate_pdf' file.id %}">
                <button id="download-pdf" type="button" class="result-button2  btn btn-outline-secondary">
                  Download
                </button>
              </a>
            {% endfor %} 
          </div>
        </div>
    </div>

    <footer class="result-footer">
      <div class="result-bottom">
        <img
          alt="pastedImage"
          src="{% static 'public/groupLogo.png' %}" 
          class="result-branding"
        />
        <span class="result-text60">Copyright © Group L - 2023</span>
      </div>
    </footer>
  </div>
{% endblock %}
